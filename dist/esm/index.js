var z=Object.defineProperty,M=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var x=(e,n,r)=>n in e?z(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,d=(e,n)=>{for(var r in n||(n={}))v.call(n,r)&&x(e,r,n[r]);if(w)for(var r of w(n))U.call(n,r)&&x(e,r,n[r]);return e},I=(e,n)=>M(e,k(n));import V from"axios";import{stringify as y,parse as R}from"qs";var O=V.create();O.interceptors.response.use(e=>e,e=>{var r,s,t;let n=I(d({},e),{message:(s=(r=e.response)==null?void 0:r.data)==null?void 0:s.message,statusCode:(t=e.response)==null?void 0:t.status});return Promise.reject(n)});var S=e=>{switch(e){case"nin":return"notIn";case"ncontains":return"notContains";case"containss":return"containsi";case"ncontainss":return"notContainsi"}return e},A=e=>{let n=[];return e&&e.map(r=>{r.order&&n.push(`${r.field}:${r.order}`)}),n},F=e=>{let n="";e&&e.map(t=>{if(t.operator!=="or"){let{field:i,operator:o,value:c}=t,u=S(o);Array.isArray(c)?c.map((a,l)=>{n+=`&filters[${i}][$${u}][${l}]=${a}`}):n+=`&filters[${i}][$${u}]=${c}`}else{let{value:i}=t;i.map((o,c)=>{let{field:u,operator:a,value:l}=o,f=S(a);n+=`&filters[$or][${c}][${u}][$${f}]=${l}`})}});let r=R(n);return y(r,{encodeValuesOnly:!0})},$=e=>{let n=s=>Object.prototype.toString.call(s)==="[object Object]",r=s=>s.attributes?d({id:s.id},s.attributes):s;if(Array.isArray(e))return e.map(s=>$(s));if(n(e)){Array.isArray(e.data)?e=[...e.data]:n(e.data)?e=r(d({},e.data)):e.data===null?e=null:e=r(e);for(let s in e)e[s]=$(e[s]);return e}return e},H=(e,n=O)=>({getList:async({resource:r,pagination:s,filters:t,sort:i,metaData:o})=>{let c=`${e}/${r}`,u=(s==null?void 0:s.current)||1,a=(s==null?void 0:s.pageSize)||10,l=o==null?void 0:o.locale,f=o==null?void 0:o.fields,p=o==null?void 0:o.populate,j=o==null?void 0:o.publicationState,g=A(i),L=F(t),q={"pagination[page]":u,"pagination[pageSize]":a,locale:l,publicationState:j,fields:f,populate:p,sort:g.length>0?g.join(","):void 0},{data:b}=await n.get(`${c}?${y(q,{encodeValuesOnly:!0})}&${L}`);return{data:$(b),total:b.meta.pagination.total}},getMany:async({resource:r,ids:s})=>{let t=`${e}/${r}`,i=s.map(c=>`filters[id][$in]=${c}`).join("&"),{data:o}=await n.get(`${t}?${i}`);return{data:$(o)}},create:async({resource:r,variables:s})=>{let t=`${e}/${r}`,i={data:s};r==="users"&&(i=s);let{data:o}=await n.post(t,i);return{data:o}},update:async({resource:r,id:s,variables:t})=>{let i=`${e}/${r}/${s}`,o={data:t};r==="users"&&(o=t);let{data:c}=await n.put(i,o);return{data:c}},updateMany:async({resource:r,ids:s,variables:t})=>({data:await Promise.all(s.map(async o=>{let c=`${e}/${r}/${o}`,u={data:t};r==="users"&&(u=t);let{data:a}=await n.put(c,u);return a}))}),createMany:async({resource:r,variables:s})=>({data:await Promise.all(s.map(async i=>{let{data:o}=await n.post(`${e}/${r}`,{data:i});return o}))}),getOne:async({resource:r,id:s,metaData:t})=>{let i=t==null?void 0:t.locale,o=t==null?void 0:t.fields,c=t==null?void 0:t.populate,a=`${e}/${r}/${s}?${y({locale:i,fields:o,populate:c},{encode:!1})}`,{data:l}=await n.get(a);return{data:$(l)}},deleteOne:async({resource:r,id:s})=>{let t=`${e}/${r}/${s}`,{data:i}=await n.delete(t);return{data:i}},deleteMany:async({resource:r,ids:s})=>({data:await Promise.all(s.map(async i=>{let{data:o}=await n.delete(`${e}/${r}/${i}`);return o}))}),getApiUrl:()=>e,custom:async({url:r,method:s,filters:t,sort:i,payload:o,query:c,headers:u})=>{let a=`${r}?`;if(i){let p=A(i);p.length>0&&(a=`${a}&${y({sort:p.join(",")})}`)}if(t){let p=F(t);a=`${a}&${p}`}c&&(a=`${a}&${y(c)}`),u&&(n.defaults.headers=d(d({},n.defaults.headers),u));let l;switch(s){case"put":case"post":case"patch":l=await n[s](r,o);break;case"delete":l=await n.delete(r);break;default:l=await n.get(a);break}let{data:f}=l;return Promise.resolve({data:f})}});import P from"axios";var h=e=>({login:async(n,r)=>{let s=`${e}/auth/local`;return await P.post(s,{identifier:n,password:r})},me:async n=>await P.get(`${e}/users/me`,{headers:{Authorization:`Bearer ${n}`}})});var G=(e,n)=>{var r;return e?{file:e.file,fileList:(r=e.fileList)!=null?r:(Array.isArray(e)?e:[...e]).map(s=>{let t={name:s.name,percent:s.percent,size:s.size,status:s.status,type:s.mime||s.type,uid:s.id};return s.url&&(t.url=`${n}${s.url}`),t})}:{fileList:[]}},J=e=>(Object.keys(e).map(n=>{if(e[n]){let r=e[n].fileList;if(Array.isArray(r)){let t=[];for(let i of r)if(i.response)for(let o of i.response)t.push(o.id);else t.push(i.uid);e[n]=t}}}),e);import{useState as m}from"react";var D=({maxCount:e})=>{let[n]=m([]),[r,s]=m([]);return{uploadedFileIds:n,beforeUpload:(i,o)=>{let c=r.length,u=o.length;if(c+u>e){let a=c+u-e,l=a-a*2;o.splice(l)}return s([...r,...o]),!0},fileList:r,maxCount:e}};export{h as AuthHelper,H as DataProvider,G as getValueProps,J as mediaUploadMapper,D as useStrapiUpload};
//# sourceMappingURL=index.js.map